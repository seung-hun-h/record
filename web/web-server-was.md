## 목차
- [Web Server & (Web) Application Server](#web-server--web-application-server)
    - [Web Server](#web-server)
    - [Application Server](#application-server)
  - [CGI: Common Gateway Interface](#cgi-common-gateway-interface)
    - [CGI의 한계](#cgi의-한계)
  - [Module](#module)
  - [Servlet](#servlet)
    - [Application Server의 특징](#application-server의-특징)
  - [서버의 분리](#서버의-분리)
  - [결론](#결론)
  - [참고](#참고)

# Web Server & (Web) Application Server
### Web Server
- 클라이언트가 요청하는 파일을 제공한다
- 제공하는 파일을 HTML, 이미지, 비디오 등 정적 컨텐츠이다

### Application Server
- 클라이언트의 요청에 대응 하는 응답을 하기 위해 비즈니스 로직을 활용한다
- 서버에서 정보를 가공한 동적인 컨텐츠를 제공한다

편의상 위 처럼 나누어 설명하지만 웹 서버는 정적 컨텐츠만 제공하고, 웹 어플리케이션 서버는 동적 컨텐츠만 제공하는 것은 아니다. 즉, 웹 서버에서도 동적인 컨텐츠를 제공할 수 있고 웹 어플리케이션 서버에서도 정적인 컨텐츠를 제공할 수 있다.

## CGI: Common Gateway Interface
초기 웹 서버는 정적인 컨텐츠만 제공했었다. 하지만 많은 사람들이 웹을 사용하면서 동적인 컨텐츠에 대한 요구가 발생했다. CGI는 웹 서버가 동적인 컨텐츠를 제공하기 위한 방법이다.

CGI는 웹 서버가 요청을 처리하기 위해 외부 프로그램을 실행할 수 있도록 하는 인터페이스이다. CGI는 [RFC3875](https://datatracker.ietf.org/doc/html/rfc3875)에 규정되어 있다.

![image](https://user-images.githubusercontent.com/60502370/161178388-488c4ab4-a7c6-48ae-8f6a-45a0d1efedef.png)


CGI를 통해 사용하는 프로그램을 CGI 스크립트라 부르고 이를 위해 주로 이용된 것이 Perl언어 였다. RFC3875에 따르면 서버는 클라이언트와 커넥션, 데이터 전송, 네트워크 이슈를 관리하는 반면에 CGI 스크립트는 데이터에 접근이나 문서 처리 같은 어플리케이션과 관련된 이슈를 다룬다.

### CGI의 한계
CGI는 웹 서버와 프로그램 사이에 요청과 응답을 주고 받기 위한 규약이기 때문에 응용 범위를 넓히기 쉬웠다. 하지만 **Perl 언어가 텍스트 처리에 강점이 있는 언어이기 때문에 대규모 어플리케이션에 적합하지 않았다.**

그리고 **사용자의 요청 당 하나의 프로세스가 할당**되어 CGI를 통해 프로그램을 실행하기 때문에 성능 상 한계도 명확했다. 

## Module
CGI의 한계를 극복 하기 위해 모듈이 나타났다. 모듈은 웹 서버와 똑같은 프로세스에서 동작하기 때문에 프로그램 실행을 위해 추가적인 프로세스가 필요하지 않았다. 하지만 CGI는 표준화된 기술로 범용성이 크다는 장점이 있지만, 모듈은 특정 웹 서버를 위해 만들어졌기 때문에 웹 서버마다 모듈을 만들어야 한다.

## Servlet
CGI는 사용자의 요청 당 1개의 프로세스를 할당하고, 대규모 어플리케이션에 적합하지 않아 한계점이 명확했다. Java는 CGI의 이러한 한계점을 해결 할 수 있었다. Java는 C 언어와 문법이 유사했고, Java EE에는 대규모 웹 어플리케이션 개발을 위한 서블릿 기능이 포함되었다. 특히 Java는 JVM 덕분에 OS에 독립적으로 프로그램을 실행할 수 있었다. JVM를 통해 실행되는 프로그램을 애플리케이션 서버라고 하며, 애플리케이션 서버가 서블릿이나 JSP를 동작시키는 구조로 되어 있다.

웹 애플리케이션 서버는 웹 애플리케이션과 서버 환경을 만들어 동작시키는 기능을 제공하는 소프트웨어 프레임워크이다. Java EE는 Java SE에 웹 컨테이너 기능을 추가적으로 제공하는데 이것이 서블릿이나 JSP의 실행 기반이된다.

### Application Server의 특징
CGI는 요청을 처리할 때마다 프로세스를 실행하는 1회성 모델인 반면, 애플리케이션 서버는 프로세스가 항상 실행되고 있다.

웹 서버와 애플리케이션 서버의 연동 방법은 표준화되어 있지 않다. 일반적으로 웹 서버에 모듈을 탑재하여 애플리케이션 서버의 통신한다. Apache HTTP Server와 Apache Tomcat도 이러한 방식으로 통신하며 이때 ajp13 이라는 프로토콜을 사용한다. HTTP 통신과 다르게 독자 규격이지만 속도와 효율면에서 HTTP 보다 이점이 있다.

## 서버의 분리
웹 서버와 애플리케이션 서버는 서로 다른 프로세스에서 동작한다. 이러한 특징 덕분에 웹 서버와 애플리케이션 서버를 서로 다른 노드(컴퓨터)에서 동작 시킬 수 있다. 이렇게 노드를 분리함에 따라 얻을 수 있는 이점은 다음과 같다.

1. 빈번하고 가벼운 정적 컨텐츠에 대한 요청은 웹 서버에서 처리, 비교적 빈번하지 않지만 무거운 동적 컨텐츠에 대한 요청은 어플리케이션 서버에서 처리
2. 어플리케이션 서버의 수평적 확장

웹 서버와 어플리케이션 서버 노드를 분리한다는 것은 인프라가 보다 복잡해질 수 있다는 것을 의미한다. 이 때문에 대부분의 애플리케이션 서버는 웹 서버의 기능 역시 가지고 있다. 따라서 웹 서버와 어플리케이션 서버를 따로 두지 않고 어플리케이션 서버 하나만으로 인프라를 구성할 수도 있다.

## 결론
- 웹 서버는 가벼운 정적인 요청, 웹 어플리케이션 서버는 무거운 동적인 요청을 주로 처리한다
- 이분법적으로 나눌 수는 없다. 
  - 웹 서버가 동적인 요청을 처리할 수도 있고, 어플리케이션 서버가 정적인 요청을 처리할 수도 있다
- 웹 서버와 어플리케이션 서버를 분리하면 다음과 같은 이점이 있다.
  - 어플리케이션 서버의 수평적 확장
  - 가벼운 요청을 웹 서버가 앞 단에서 처리하여 어플리케이션 서버의 부담을 줄일 수 있다
  - 어플리케이션 서버에 문제가 발생해도 웹 서버는 동작하여 사용자에게 문제가 있음을 알릴 수 있다

## 참고
- https://ko.wikipedia.org/wiki/%EC%9B%B9_%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98_%EC%84%9C%EB%B2%84
- https://www.nginx.com/resources/glossary/application-server-vs-web-server/
- https://datatracker.ietf.org/doc/html/rfc3875
- https://pkeu.notion.site/pkeu/Nginx-ab4282c71ccb4efaaaadf840deb8c06a
