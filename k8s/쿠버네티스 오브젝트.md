## 오브젝트
- **쿠버네티스 오브젝트**는 쿠버네티스 시스템에서 영속성을 가지는 오브젝트이다
	- 영속성을 가진다는 것은 쿠버네티스 시스템 내에서 지속적으로 존재하고 관리된다는 의미다
- 쿠버네티스 클러스터의 상태를 나타내기 위해 오브젝트를 사용한다
	- 어떤 애플리케이션이 어떤 노드에서 동작 중인지
	- 애플리케이션이 이용할 수 있는 리소스
	- 애플리케이션이 어떻게 재구동 정책, 업그레이드, 그리고 내고장성과 같은 것에 동작해야 하는지에 대한 정책
- 오브젝트는 **스펙(spec)** 과 **상태(status)** 그리고 개별적인 특성을 가진다
- 오브젝트를 생성하여 쿠버네티스 클러스터의 [워크로드](https://kubernetes.io/ko/docs/concepts/workloads/)를 어떤 형태로 보이고자하는지 효과적으로 쿠버네티스 시스템에 전달한다
- 쿠버네티스 클러스터가 **의도한 상태** 를 유지하도록 한다

### 기본 오브젝트
- 파드
	- 쿠버네티스에서 실행되는 최소 단위
	- 독립적인 공간과 사용 가능한 IP를 가지고있다
	- 하나의  파드는 1개 이상의 컨테이너를 가지고 있다
- 네임스페이스
	- 쿠버네티스 클러스터에서 사용되는 리소스들을 구분해 관리하는 그룹
- 볼륨
	- 파드가 사라지더라도 저장과 보존이 가능한 디렉터리를 생성한다
- 서비스
	- 클러스터 내부의 파드를 외부와 연결하거나, 클러스터 내부에서 파드 간의 통신을 추상화하는데 사용
	- 일반적으로 여러 개의 동일한 파드에 대한 단일 진입점 역할을 하며, 로드 밸런싱, 게이트웨이 역할
	- 쿠버네티스 외부에서 쿠버네티스 내부로 접속할 때 파드가 살았는지, 죽었는지 신경쓰지 않아도 이를 논리적으로 연결하는 오브젝트
	- 쿠버네티스  외부에서 쿠버네티스 클러스터 내부에 접속하는 방법 

### 디플로이먼트
- 애플리케이션의 원하는 상태를 정의하고, 이 상태를 유지하기 위해 필요한 파드의 수와 업데이트 전략 등을 관리하는 오브젝트
- 파드에 기반을 두고 있고, 레플리카셋 오브젝트를 합쳐 놓은 형태
- 상태가 없는 애플리케이션의 실행과 관리에 사용되며, 선언적으로 원하는 파드의 수와 업데이트 전략을 지정할 수 있다

### 그 외 오브젝트
- 스테이트풀셋
	- 상태가 있는 애플리케이션의 실행과 관리에 사용된다
	- 각 파드에 식별자와 순차적인 순서를 부여한다
	- 안정적인 스토리지와 네트워크를 지원한다
	- 분산 데이터베이스, 메시지 큐 등의 상태가 있는 애플리케이션을 실행할 수 있다
- 데몬셋
	- 각 노드에서 하나의 파드 인스턴스를 실행하도록 보장하는 오브젝트
- 잡
	- 일회성 작업을 수행하는 오브젝트
	- 하나 이상의 파드를 생성하고 지정된 수의 파드가 성공적으로 종료될 때까지 계속해서 파드의 실행을 재시도한다
	- 파드가 성공적으로 완료되면, 성공적으로 완료된 잡을 추적한다
	- 지정된 수의 성공 완료에 도달하면, 작업(즉, 잡)이 완료된다
	- 잡을 삭제하면 잡이 생성한 파드가 정리된다
- 크론잡
	- 잡을 크론 형식으로 쓰여진 주어진 일정에 따라 주기적으로 동작시킨다.
- 레플리카셋
	- 원하는 수의 동일한 파드를 생성하고 유지하는데 사용된다
	- 일반적으로 디플로이먼트를 통해서 간접적으로 사용된다

## 스펙과 상태
- 스펙(spec)은 오브젝트를 생성할 때 리소스에 원하는 오브젝트의 특징을 설명한다
- 상태(status)는 오브젝트의 현재 상태를 말한다
	- 쿠버네티스 [컨트롤 플레인](https://kubernetes.io/ko/docs/reference/glossary/?all=true#term-control-plane)은 모든 오브젝트의 실제 상태를 사용자가 의도한 상태와 일치시키기 위해 끊임없이 그리고 능동적으로 관리한다.

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  label:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.14.2
        ports:
        - containerPort: 80
```

1.  `apiVersion`: 사용할 쿠버네티스 API 버전을 지정. 여기서는 "apps/v1" 버전을 사용
2.  `kind`: 생성할 오브젝트의 종류를 지정. 여기서는 디플로이먼트(Deployment)를 생성.
3.  `metadata`: 오브젝트에 대한 메타데이터를 정의. 여기서는 디플로이먼트 이름이 "nginx-deployment"로 지정.
4.  `spec`: 오브젝트의 동작을 정의하는 스펙을 지정. 여기서는 디플로이먼트에 대한 스펙을 정의하고 있다.
    -   `replicas`: 디플로이먼트에 의해 생성될 파드의 수를 지정\. 여기서는 3개의 복제본이 생성.
    -   `selector`: 어떤 파드를 이 디플로이먼트의 관리 대상으로 할 것인지를 지정하는 라벨 셀렉터를 정의. 여기서는 "app"이 "nginx"인 라벨을 가진 파드를 선택.
    -   `template`: 생성될 파드의 템플릿을 정의.
        -   `metadata`: 파드에 대한 메타데이터를 정의. 여기서는 "app" 라벨을 "nginx"로 설정.
        -   `spec`: 파드의 스펙을 정의.
            -   `containers`: 파드에 포함될 컨테이너를 정의. 여기서는 "nginx" 컨테이너를 생성하고, "nginx:1.14.2" 이미지를 사용. 또한, 컨테이너의 포트 80을 연다.

```command
kubectl apply -f https://k8s.io/examples/application/deployment.yaml
```

- `metadata` 하위의 `label`은 해당 오브젝트(여기서는 디플로이먼트)에 적용된다
- `template` 하위의 `label`은 해당 컨테이너에 적용된다