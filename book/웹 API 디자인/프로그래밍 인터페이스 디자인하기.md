## REST API
- REST란?
- REST API는 HTTP를 단순히 사용하고 있는 정도가 아니라 완전히 의존하고 있다

#### REST API 구성
- 경로
	- 서버상의 리소스를 식별할 수 있는 주소
	- `/products/p123`
- HTTP 메서드
	- 리소스를 가지고 행해고 싶은 행위
- HTTP 상태 코드
	- 요청에 대한 처리가 어떻게 되고 있는지 나타내는 요소
- Response Body
	- 요청 경로로 식별된 리소스의 컨텐츠를 포함

## API 목표를 REST API로 변형
![IMG_0619](https://github.com/seung-hun-h/record/assets/60502370/6eaca2a9-5b2c-46e7-85ae-e2454ea9bf82)

1. API 목표 캔버스
2. 리소스와 리소스 사이 관계 식별
	1. '추가한다', '조회한다' 같은 주요 동사와 '상품', '카탈로그' 같은 주요 명사를 나열
	2. 리소스를 식별
	3. 비정형 질의는 리소스가 아니다.
	4. 일정한 타입의 리소스를 여러 개를 포함하는 리소스를 **콜렉션** 혹은 **콜렉션 리소스**라 한다
3. 액션, 액션의 파라미터, 반환값 식별
	1. 상품을 카탈로그 하위에 추가, 카탈로그에서 상품을 조회하면 추가와 조회는 카탈로그 리소스로 연결되는 것이 맞다
	2. 액션의 영향을 받는 리소스는 입력에서 무시해야 한다
		1. 카탈로그에 상품을 추가, 카탈로그의 상품을 조회할 때는 카탈로그의 정보는 입력에서 제외한다
4. 경로를 포함한 리소스 표현
	1. REST 리소스 경로는 반드시 유일해야 한다
	2. `/{productId}` 처럼 경로에 사용되는 변수는 **경로 파라미터(Path parameter)** 라 한다
	3. `/catalog/{productId}`, `/products/{productId}` 모두 가능하다
	4. '/상위리소스의 복수형/{상위리소스 ID}/하위리소스의 복수형/{하위리소스 ID}' 처럼 복잡해지는 경우도 있다
5. HTTP로 액션 표현

| HTTP 메서드               | 액션                                                                                               |
| ------------------------- | ------------------------------------------------------ |
| POST( 및 PUT을 통한 생성) | 고객 생성, 메뉴에 음식 추가, 상품 주문, 타이머 시작, 메시지를 고객 서비스에 발송, 계약서 서명 등등 |
| GET                       | 고객 정보 읽기, 프랑스 음식 레스토랑 검색, 계약서 다운로드 등등                                   |
| PATCH, PUT                | 고객 정보 수정, 주문서 상품 변경, 비행기 좌석 변경 등등                                         |
| DELETE                    | 고객 삭제, 주문 취소, 타이머 중지 등등                                                             |

## API 데이터 디자인
- 속성을 나열하고 컨슈머 관점을 고수하는 것으로 시작한다
- 컨슈머가 데이터를 이해하도록 만드는 동시에 내부 동작 원리를 노출하지 않는 디자인을 만들어야 한다

### 컨셉 디자인
- 식별하고 REST 리소스로 변환 시킨 컨셉들은 파라미터와 리스폰스가 되어 컨슈머와 프로바이더 사이를 오간다
- 속성
	- 이름
		- 가장 중요한 속성. 자신을 잘 설명할 수 있는 이름이어야 한다
	- 타입
		- 기본 포터블 데이터 타입이 좋다. 포터블 타입이란 string, boolean, number, date, object, array 등을 말한다
	- 필수 여부
		- 속성이 필수적인지 선택적인지를 나타낸다
	- 부가설명
		- 이름과 타입만으로 속성을 표현하기 어려울 때는 부가 설명이 중요하다

### 컨셉에서 리스폰스 디자인
- 항상 컨텍스트에 맞게 속성을 제거하거나 이름을  변경해야 한다
	- 상품 추가하기, 가져오기는 모든 상품 정보를 반환
	- 상품 조회하기는 상품의 참조, 이름, 가격, 공급사 이름만 반환

### 컨셉과 리스폰스에서 파라미터 디자인
- 파라미터는 반드시 필요한 데이터만을 제공해야 하고 불필요한 데이터는 제공하면 안된다
- 백엔드가 자체적으로 처리할 수 있는 데이터를 포함하면 안된다
- 같은 컨셉이더라도 컨텍스트에 따라 다른 API 파라미터 표현을 가질 수도 있다

### 데이터 소스에서 파라미터 확인
- 컨슈머는 반드시 파라미터로 필요한 데이터를 모두 제공할 수 있어야 한다
	- 데이터가 제공되지 않는다면, 목표를 놓쳤거나 프로바이더 관점이 남아있을 수 있다

#### 모든 파라미터의 데이터를 컨슈머가 제공할 수 있는지 검증

![IMG_0620](https://github.com/seung-hun-h/record/assets/60502370/c7a0667f-6b48-4fc5-904a-8ba8bbe71441)

- API 디자인은 계속해서 발전해나가는 과정
	- 반복적인 정제 작업을 통해 정확하고, 완벽하고, 효율적인 방향으로 나아간다

## 디자인적 난관에 봉착했을 때 균형 유지하는 법
#### REST 절충안 예시
- REST 리소스의 액션을 HTTP 메서드와 연결짓는 것을 실패할 때, 가장 먼저 해볼 수 있는 선택지는 액션 자체를 의미하는 리소스를 만드는 것이다
	- 액션을 트리거하는 HTTP 메서드는 **POST**이다
- 사용자가 상품을 구입
		- 카트 리소스의 경로를 `/cart`로 정했다면 `/cart/check-out`으로 표현할 수 있다
		- 혹은 `/check-out-cart`도 할 수 있다
		- 혹은 `POST /orders`로 주문을 생성할 수도 있다
- 가장 중요한 것은 API 컨슈머 혹은 다른 API 디자이너와 대화하는 것이다

## API를 디자인할 때 REST가 중요한 이유
- REST API는 API를 디자인할 때 중요한 원칙을 담고 있다
- gRPC, GraphQL등 REST가 아닌 API를 디자인할 때도 REST API의 디자인 원칙을 적용할 수 있는 것이다

### REST 아키텍처 스타일
- REST 아키텍처 스타일의 목표는 효율적이고 확장 가능하며 안정적인 분산 시스템을 구축하는 것이다
	- 분산 시스템이란 서로 다른 컴퓨터에 위치한 소프트웨어 조각들이 네트워크를 통해 함께 동작하는 시스템을 말한다
- RESTful을 위한 소프트웨어 아키텍처 제약 사항
	- 클라이언트/서버
	- 스테이트리스
	- 캐시 가능성
	- 레이어드 시스템
	- 코드 온 디멘드
	- 유니폼 인터페이스
- 이러한 제약 사항은 모든 API 타입에도 큰 영향을 미친다