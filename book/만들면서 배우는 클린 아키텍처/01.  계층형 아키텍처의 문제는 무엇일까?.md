### 계층형 아키텍처란

<img width="317" alt="image" src="https://github.com/seung-hun-h/record/assets/60502370/41291c5e-2aee-4fde-acf2-0ec01c549ebc">

- **웹 계층**: 요청을 받아 도메인 혹은 비즈니스 계층에 있는 서비스로 요청을 보낸다
- **도메인 계층**: 필요한 비즈니스 로직을 수행한고 영속성 계층을 호출한다
- **영속성 계층**: 데이터를 영속화한다

계층형 아키텍처는 견고한 아키텍처다. 하지만 코드에 **나쁜 습관**이 스며들기 쉽게한다

### 계층형 아키텍처의 단점
#### 데이터베이스 주도 설계를 유도한다
ORM(JPA, Mybatis)를 사용하면 **비즈니스 계층와 영속화 계층이 결합**되기 쉽다. 
- 영속성 모델을 비즈니스 모델처럼 사용한다
- 트랜잭션, 지연로딩, 즉시로딩 등 영속성 계층과 관련된 작업을 해야한다

ORM을 사용하면 데이터베이스 구조를 먼저 생각하게 만든다. 하지만 비즈니스 관점에서는 도메인 로직이 가장 먼저 작성되어야 한다.
#### 지름길을 택하기 쉬워진다
계층형 아키텍처에서는 한 계층에서는 같은 계층이나 하위 계층에만 접근해야 한다. 만약 상위 계층에 접근해야 한다면 **상위 계층의 컴포넌트를 아래로 내려버리기 쉽다**. 이를 시스템적으로 막을 필요가 있다
- 헬퍼, 유틸리티 컴포넌트를 아래 계층으로 내리기 쉽다
- 하위 계층이 비대해진다
#### 테스트하기 어려워진다
계층형 아키텍처에서는 필드가 몇개 변하지 않는 상황에서 **웹 계층에서 영속성 계층으로 바로 접근**하려 시도할 수 있다
- 도메인 로직을 웹 계층에 구현하게 된다
- 영속성 계층도 모킹해야 한다
- 영속성 컴포넌트에 의존성이 쌓이면서 목을 만드는데 많은 시간이 걸리게된다
#### 유즈케이스를 숨긴다
기능을 추가하거나 변경할 위치를 찾는 경우가 빈번하기 때문에 아키텍처는 코드를 빠르게 찾는데 도움이 되어야 한다. 계층형 아키텍처는 시간이 지나면서 여러 개의 유즈케이스를 담당하는 **넓은 서비스가 만들어지기 쉽다**
#### 동시 작업이 어려워진다
**영속성 계층 -> 도메인 계층 -> 웹 계층 순서**로 만들어야 하므로 특정 기능을 동시에 작업하기 어렵다. 코드에 **넓은 서비스**가 있다면 서로 다른 기능을 동시에 작업하기 어렵다


