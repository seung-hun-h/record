# 16. CompletableFuture: 안정적 비동기 프로그래밍
## 16.1 Future의 단순 활용
- 자바 5부터는 `Future` 인터페이스를 제공한다
  - 비동기 모델링 하는데 사용할 수 있다
  - 계산이 끝났을 때 결과에 접근할 수 있는 참조를 제공한다(`get()`)
  - 시간이 걸릴 수 있는 작업을 `Future` 내부로 설정하면 호출자 스레드가 결과를 기다리는 동안 다른 유용한 작업을 수행할 수 있다

![image](https://user-images.githubusercontent.com/60502370/183290831-98c01ba2-7342-4cf1-afc7-416c6076e58e.png)

- 위 코드에서는 오래 걸리는 작업이 영원히 끝나지 않는 경우에 대비해 타임아웃을 설정하였다

### 16.1.1 Future 제한
- `Future` 인터페이스는 계산이 끝났는지 확인 할 수 있는 메서드, 계산이 끝나길 기다리는 메서드, 결과 회수 메서드 등을 제공한다
- 이들 메서드 만으로는 간결한 동시 실행 코드를 구현하기 충분하지 않다
  - 여러 `Future`의 결과가 있을 때 이들의 의존성을 표현하기 어렵다
  - 'A의 연산이 끝난 후 B 연산을 수행하고 다른 질의 결과와 B의 결과를 조합하라' 와 같은 요구 사항을 구현하기 어렵다
- 다음과 같은 선언형 기능이 있다면 동시 실행 코드를 구현하기 유용할 것이다
  - 두 개의 비동기 계산 결과를 합친다. 두 개의 연산은 독립적일 수도 있고, 순서에 의존할 수 있다
  - `Future` 집합이 실행하는 모든 태스크의 완료를 기다린다
  - `Future` 집합에서 가장 빨리 완료되는 태스크를 기다렸다가 결과를 얻는다
  - 프로그램적으로 `Future`를 완료시킨다(비동기 동작에 수동으로 결과 제공)(?)
  - `Future` 완료 동작에 반응한다

- `CompletableFuture`는 이러한 기능을 선언형으로 사용할 수 있도록 제공한다

### 16.1.2 CompletableFuture로 비동기 애플리케이션 만들기
- 내용 생략

**동기 API와 비동기 API**
- 동기 API는 메서드를 호출한 다음에 메서드가 계산을 완료할 때까지 기다렸다가 메서드가 반환되면 호출자는 반환된 값으로 계속 다른 동작을 수행한다
  - 호출자와 피호출자가 다른 스레드에서 실행되더라도 호출자는 피호출자의 동작 완료를 기다렸을 것이다
  - 이처럼 동기 API를 사용하는 상황을 블록 호출이라 한다
- 비동기 API는 메서드가 즉시 반환되며 끝내지 못한 나머지 작업을 호출자 스레드와 동기적으로 실행될 수 있도록 다른 스레드에 할당한다
  - 비동기 API를 사용하는 상황을 비블록 호출이라고 한다